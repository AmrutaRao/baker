



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>Migration Guide v3 - Baker</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/ing.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#migration-guide-v3" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="Baker" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Baker
            </span>
            <span class="md-header-nav__topic">
              
                Migration Guide v3
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../.." title="Baker" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Baker
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ing-bank/baker/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ing-bank/baker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Development Life Cycle
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Development Life Cycle
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/design-a-recipe/" title="Design a Recipe" class="md-nav__link">
      Design a Recipe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/use-visualizations/" title="Use Visualizations" class="md-nav__link">
      Use Visualizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/implement-interactions/" title="Implement Interactions" class="md-nav__link">
      Implement Interactions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/bake-fire-events-and-inquiry/" title="Bake, Fire Events and Inquiry" class="md-nav__link">
      Bake, Fire Events and Inquiry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/test/" title="Test" class="md-nav__link">
      Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/configure/" title="Configure" class="md-nav__link">
      Configure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/monitor/" title="Monitor" class="md-nav__link">
      Monitor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../development-life-cycle/resolve-failed-recipe-instances/" title="Resolve Failed Recipes" class="md-nav__link">
      Resolve Failed Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/main-abstractions/" title="Main Abstractions" class="md-nav__link">
      Main Abstractions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/execution-semantics/" title="Execution Semantics" class="md-nav__link">
      Execution Semantics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/baker-types-and-values/" title="Baker Types and Values" class="md-nav__link">
      Baker Types and Values
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/dsls/" title="Recipe DSLs" class="md-nav__link">
      Recipe DSLs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/runtime/" title="The Akka Based Runtime" class="md-nav__link">
      The Akka Based Runtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/visualization/" title="Visualization" class="md-nav__link">
      Visualization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/event-listener/" title="Event Listener" class="md-nav__link">
      Event Listener
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/stores/" title="Event Stores and Cluster Configuration" class="md-nav__link">
      Event Stores and Cluster Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Versions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Versions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../baker-3-release-notes/" title="Release Notes v3" class="md-nav__link">
      Release Notes v3
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Migration Guide v3
      </label>
    
    <a href="./" title="Migration Guide v3" class="md-nav__link md-nav__link--active">
      Migration Guide v3
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#from-2xx-to-300" title="From 2.X.X to 3.0.0" class="md-nav__link">
    From 2.X.X to 3.0.0
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downtime-required-for-clusters-with-state" title="Downtime required for clusters with state" class="md-nav__link">
    Downtime required for clusters with state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renamespackage-changes" title="Renames/package changes" class="md-nav__link">
    Renames/package changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-and-completablefuture" title="Future and CompletableFuture" class="md-nav__link">
    Future and CompletableFuture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-baker-instance" title="Creating a Baker instance" class="md-nav__link">
    Creating a Baker instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-interactions-into-baker" title="Adding Interactions into Baker" class="md-nav__link">
    Adding Interactions into Baker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firing-events" title="Firing events" class="md-nav__link">
    Firing events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#small-changes" title="Small changes" class="md-nav__link">
    Small changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-artery-for-akka-remoting" title="About Artery for Akka remoting" class="md-nav__link">
    About Artery for Akka remoting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency" title="Dependency" class="md-nav__link">
    Dependency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../baker-2/" title="Migration Guide v2" class="md-nav__link">
      Migration Guide v2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../feature-comparison/" title="Feature comparison" class="md-nav__link">
      Feature comparison
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#from-2xx-to-300" title="From 2.X.X to 3.0.0" class="md-nav__link">
    From 2.X.X to 3.0.0
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downtime-required-for-clusters-with-state" title="Downtime required for clusters with state" class="md-nav__link">
    Downtime required for clusters with state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renamespackage-changes" title="Renames/package changes" class="md-nav__link">
    Renames/package changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-and-completablefuture" title="Future and CompletableFuture" class="md-nav__link">
    Future and CompletableFuture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-baker-instance" title="Creating a Baker instance" class="md-nav__link">
    Creating a Baker instance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-interactions-into-baker" title="Adding Interactions into Baker" class="md-nav__link">
    Adding Interactions into Baker
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firing-events" title="Firing events" class="md-nav__link">
    Firing events
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#small-changes" title="Small changes" class="md-nav__link">
    Small changes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-artery-for-akka-remoting" title="About Artery for Akka remoting" class="md-nav__link">
    About Artery for Akka remoting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency" title="Dependency" class="md-nav__link">
    Dependency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ing-bank/baker/edit/master/docs/sections/versions/baker-3.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="migration-guide-v3">Migration Guide v3</h1>
<h2 id="from-2xx-to-300">From 2.X.X to 3.0.0</h2>
<p>This guide only describes how to migrate your existing application.
For a full list new features see the <a href="../baker-3-release-notes">release notes</a>.</p>
<p>Summary:</p>
<ul>
<li><em>ALL</em> persisted data from older baker versions <em>IS COMPATIBLE</em> and can be used with <code>3.0.0</code></li>
<li>When running a cluster <em>DOWNTIME IS REQUIRED</em> because of binary incompatible changes in the message protocol.</li>
<li>Code changes are needed to comply to the new Baker interface</li>
<li>No code changes needed to the Recipe (except the removal of the sieve concept)</li>
</ul>
<h3 id="downtime-required-for-clusters-with-state">Downtime required for clusters with state</h3>
<p>In <code>3.0.0</code> some binary incompatible changes where made in the message protocol.</p>
<p>This requires you to bring down the entire cluster (<code>2.x.x</code>) and bring it up again (<code>3.0.0</code>).</p>
<p>A rolling deploy is tested but is NOT recommended.
During the rolling deploy messages regarding handling events will fail.
It is safer to bring the complete cluster down.</p>
<h3 id="renamespackage-changes">Renames/package changes</h3>
<ul>
<li>com.ing.baker.runtime.core -&gt; com.ing.baker.runtime.javadsl/scaladsl/common (depends per object)</li>
<li>com.ing.baker.runtime.java_api -&gt; com.ing.baker.runtime.javadsl</li>
<li>processId -&gt; recipeInstanceId</li>
<li>getProcessId -&gt; GetRecipeInstanceId</li>
<li>RuntimeEvent -&gt; EventInstance</li>
<li>ProcessState -&gt; RecipeInstanceState</li>
</ul>
<h3 id="future-and-completablefuture">Future and CompletableFuture</h3>
<p>The new Java and Scala interfaces now almost always return a Future or CompletableFuture.
It is now up to the user to handle waiting for the completion of this future.
This can either be by blocking directly or by 'correctly' programming with these Futures.
We REALLY advise to invest in programming in a non blocking fashion!</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Scala</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">//Blocking</span>
<span class="k">val</span> <span class="n">futureStatus</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">SensoryEventStatus</span><span class="o">]</span> <span class="k">=</span> <span class="n">baker</span><span class="o">.</span><span class="n">fireEventAndResolveWhenReceived</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">event</span><span class="o">)</span>
<span class="k">val</span> <span class="n">status</span><span class="k">:</span> <span class="kt">SensoryEventStatus</span> <span class="o">=</span> <span class="nc">Await</span><span class="o">.</span><span class="n">result</span><span class="o">(</span><span class="n">futureStatus</span><span class="o">,</span> <span class="mi">10</span> <span class="n">seconds</span><span class="o">)</span>

<span class="c1">//Non Blocking</span>
<span class="k">val</span> <span class="n">futureStatus</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">SensoryEventStatus</span><span class="o">]</span> <span class="k">=</span> <span class="n">baker</span><span class="o">.</span><span class="n">fireEventAndResolveWhenReceived</span><span class="o">(</span><span class="n">orderId</span><span class="o">,</span> <span class="n">event</span><span class="o">)</span>
<span class="n">futureStatus</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">sensoryEventStatus</span> <span class="k">=&gt;</span> <span class="o">{</span>
     <span class="c1">//Code to handle status</span>
<span class="o">})</span>
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Java</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">//Blocking</span>
<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">SensoryEventStatus</span><span class="o">&gt;</span> <span class="n">futureStatus</span> <span class="o">=</span>
                <span class="n">baker</span><span class="o">.</span><span class="na">fireEventAndResolveWhenReceived</span><span class="o">(</span><span class="n">uuid</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">EventInstance</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="k">new</span> <span class="n">ExampleEvent</span><span class="o">()));</span>
<span class="n">SensoryEventStatus</span> <span class="n">sensoryEventStatus</span> <span class="o">=</span> <span class="n">futureStatus</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>


<span class="c1">//Non blocking</span>
<span class="n">CompletableFuture</span><span class="o">&lt;</span><span class="n">SensoryEventStatus</span><span class="o">&gt;</span> <span class="n">futureStatus</span> <span class="o">=</span>
                <span class="n">baker</span><span class="o">.</span><span class="na">fireEventAndResolveWhenReceived</span><span class="o">(</span><span class="n">uuid</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">eventInstance</span><span class="o">));</span>

<span class="n">futureStatus</span><span class="o">.</span><span class="na">thenApply</span><span class="o">(</span><span class="n">sensoryEventStatus</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="c1">//Code to handle status</span>
<span class="o">});</span>
</pre></div></div>
</div>
<p>Any Exceptions that used to be thrown by Baker are now encapsulated in the Future/CompletableFuture.
For the CompletableFuture the original exception is wrapped in the ExecutionException.
This is how CompletableFuture work and there is no way around it.</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Java</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="c1">//Blocking</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">baker</span><span class="o">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="o">(</span><span class="n">processId</span><span class="o">,</span> <span class="n">EventInstance</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="k">new</span> <span class="n">ExampleEventClass</span><span class="o">())).</span><span class="na">get</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ExecutionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getCause</span><span class="o">()</span> <span class="k">instanceof</span> <span class="n">BakerException</span><span class="o">.</span><span class="na">NoSuchProcessException</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//Code to handle NoSuchProcessException</span>
    <span class="o">}</span>
    <span class="c1">//Code to handle other Exceptions</span>
<span class="o">}</span>


<span class="c1">//Non blocking</span>
<span class="n">baker</span><span class="o">.</span><span class="na">fireEventAndResolveWhenCompleted</span><span class="o">(</span><span class="n">processId</span><span class="o">,</span> <span class="n">EventInstance</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="k">new</span> <span class="n">ExampleEventClass</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">exceptionally</span><span class="o">(</span><span class="n">exception</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">exception</span><span class="o">.</span><span class="na">getCause</span><span class="o">()</span> <span class="k">instanceof</span> <span class="n">BakerException</span><span class="o">.</span><span class="na">NoSuchProcessException</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//Decide on what to return on NoSuchProcessException</span>
            <span class="o">}</span>
            <span class="c1">//Decide on what to return on other Exceptions</span>
        <span class="o">});</span>
</pre></div></div>
</div>
<h3 id="creating-a-baker-instance">Creating a Baker instance</h3>
<p>A Baker instance is now created not with a constructor but via a static method.</p>
<p>For Java the JBaker is gone and you now create a Baker under the javadsl package.</p>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">Scala</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">com.ing.baker.runtime.scaladsl.</span><span class="o">*;</span>
<span class="o">......</span>
<span class="k">val</span> <span class="n">actorSystem</span><span class="k">:</span> <span class="kt">ActorSystem</span> <span class="o">=</span> <span class="nc">ActorSystem</span><span class="o">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">materializer</span><span class="k">:</span> <span class="kt">Materializer</span> <span class="o">=</span> <span class="nc">ActorMaterializer</span><span class="o">()</span>
<span class="k">val</span> <span class="n">config</span><span class="k">:</span> <span class="kt">Config</span> <span class="o">=</span> <span class="nc">ConfigFactory</span><span class="o">.</span><span class="n">load</span><span class="o">()</span>
<span class="k">val</span> <span class="n">baker</span> <span class="k">=</span> <span class="nc">Baker</span><span class="o">.</span><span class="n">akka</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="n">actorSystem</span><span class="o">);</span>
</pre></div></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">Java</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">com.ing.baker.runtime.javadsl.*</span><span class="o">;</span>
<span class="o">......</span>
<span class="n">ActorSystem</span> <span class="n">actorSystem</span> <span class="o">=</span> <span class="n">ActorSystem</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">&quot;WebshopSystem&quot;</span><span class="o">);</span>
<span class="n">Materializer</span> <span class="n">materializer</span> <span class="o">=</span> <span class="n">ActorMaterializer</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">actorSystem</span><span class="o">);</span>
<span class="n">Config</span> <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigFactory</span><span class="o">.</span><span class="na">load</span><span class="o">();</span>
<span class="n">Baker</span> <span class="n">baker</span> <span class="o">=</span> <span class="n">Baker</span><span class="o">.</span><span class="na">akka</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="n">actorSystem</span><span class="o">);</span>
</pre></div></div>
</div>
<p>See the <a href="../../reference/runtime">runtime reference</a> for more details</p>
<h3 id="adding-interactions-into-baker">Adding Interactions into Baker</h3>
<p>When adding InteractionInstances formerly known as InteractionImplementations to Baker you now need to give a real InteractionInstance object.</p>
<div class="superfences-tabs">
<input name="__tabs_4" type="radio" id="__tab_4_0" checked="checked" />
<label for="__tab_4_0">Scala</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">reserveItemsInstance</span><span class="k">:</span> <span class="kt">InteractionInstance</span> <span class="o">=</span>
    <span class="nc">InteractionInstance</span><span class="o">.</span><span class="n">unsafeFrom</span><span class="o">(</span><span class="k">new</span> <span class="nc">ReserveItemsInstance</span><span class="o">)</span>
<span class="n">baker</span><span class="o">.</span><span class="n">addInteractionInstance</span><span class="o">(</span><span class="n">reserveItemsInstance</span><span class="o">)</span>
</pre></div></div>
<input name="__tabs_4" type="radio" id="__tab_4_1" />
<label for="__tab_4_1">Java</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><span class="n">InteractionInstance</span> <span class="n">reserveItemsInstance</span> <span class="o">=</span>
    <span class="n">InteractionInstance</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="k">new</span> <span class="n">ReserveItemsInstance</span><span class="o">());</span>
<span class="n">baker</span><span class="o">.</span><span class="na">addInteractionInstance</span><span class="o">(</span><span class="n">reserveItemsInstance</span><span class="o">)</span>
</pre></div></div>
</div>
<h3 id="firing-events">Firing events</h3>
<p>The processEvent has been completely rewritten and is now named FireEvent.
See the <a href="../baker-3-release-notes/#firing-events-into-baker">release note</a> or <a href="../../development-life-cycle/bake-fire-events-and-inquiry/#fire-events">fire event section</a> for more details</p>
<h3 id="small-changes">Small changes</h3>
<ul>
<li>dropped .withSieves on the recipe, add these with .withInteractionInstances</li>
<li>removed support in the interface for UUID, for interaction interfaces a UUID is still supported for backwards compatability reasons.</li>
</ul>
<h3 id="about-artery-for-akka-remoting">About Artery for Akka remoting</h3>
<p>Akka has released a new remoting protocol called <a href="https://doc.akka.io/docs/akka/current/remoting-artery.html">Artery</a>
This is very interesting for Baker users that have Akka cluster.
We have successfully migrated to this from the old remoting and see stability and performance gains.</p>
<h3 id="dependency">Dependency</h3>
<p>We have noticed that when using Baker in a maven project the dependencies are not always take over correctly.
If you have the following dependencies in your project please upgrade them:
* org.typelevel.cats-core_2.12 1.5.0
* org.typelevel.cats-effect_2.12 1.2.0
* All Akka dependencies to 2.5.22 (should work with other 2.5.X versions but 2.5.22 is the one we tested).</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../baker-3-release-notes/" title="Release Notes v3" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Release Notes v3
              </span>
            </div>
          </a>
        
        
          <a href="../baker-2/" title="Migration Guide v2" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Migration Guide v2
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
  </body>
</html>